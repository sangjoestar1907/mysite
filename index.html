<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Saki Hub - Blox Fruits Event Tracker</title>

  <link rel="icon" type="image/png" href="logo.png">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%);
      color: #fff;
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Header */
    header {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 15px 0;
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(10px);
      position: sticky;
      top: 0;
      z-index: 1000;
      border-bottom: 1px solid #333;
    }

    .logo {
      font-size: 24px;
      font-weight: bold;
      cursor: pointer;
      color: #fff;
      padding: 8px 16px;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 12px;
      background: linear-gradient(45deg, #ff6b6b, #feca57);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .logo img {
      height: 32px;
      border-radius: 8px;
    }

    .logo:hover {
      transform: scale(1.05);
    }

    /* Menu Button */
    .dropbtn {
      position: absolute;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
      padding: 12px 16px;
      font-size: 20px;
      border: none;
      cursor: pointer;
      border-radius: 8px;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }

    .dropbtn:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-50%) scale(1.1);
    }

    /* Sidebar */
    .dropdown-content {
      height: 100vh;
      width: 280px;
      position: fixed;
      top: 0;
      left: -280px;
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(20px);
      overflow-x: hidden;
      transition: left 0.4s ease, opacity 0.4s ease;
      z-index: 2000;
      padding-top: 0;
      opacity: 0;
      border-right: 1px solid #333;
    }

    .dropdown-content.show {
      left: 0;
      opacity: 1;
    }

    .sidebar-logo {
      color: #fff;
      font-size: 22px;
      margin: 0;
      padding: 25px 20px;
      text-align: left;
      background: linear-gradient(45deg, #ff6b6b, #feca57);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-weight: bold;
      border-bottom: 1px solid #333;
    }

    .dropdown-content a {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 18px 25px;
      color: #fff;
      text-decoration: none;
      transition: all 0.3s ease;
      border-left: 4px solid transparent;
    }

    .dropdown-content a i {
      width: 20px;
      text-align: center;
    }

    .dropdown-content a:hover {
      background: rgba(255, 255, 255, 0.1);
      border-left: 4px solid #feca57;
      padding-left: 30px;
    }

    .dropdown-content a.active {
      background: rgba(254, 202, 87, 0.1);
      border-left: 4px solid #feca57;
    }

    /* Main Content */
    .container {
      max-width: 1200px;
      margin: 40px auto;
      padding: 30px;
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.5s ease;
    }

    .container.show {
      opacity: 1;
      transform: translateY(0);
    }

    /* Overlay */
    #overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 3000;
      transition: opacity 0.5s ease;
    }

    #overlay.hide {
      opacity: 0;
      pointer-events: none;
    }

    .spinner {
      border: 4px solid rgba(255, 255, 255, 0.1);
      border-top: 4px solid #feca57;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Buttons */
    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
    }

    .btn-primary {
      background: linear-gradient(45deg, #ff6b6b, #feca57);
      color: #000;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(254, 202, 87, 0.3);
    }

    .btn-discord {
      background: #5865F2;
      color: white;
    }

    .btn-discord:hover {
      background: #4752c4;
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(88, 101, 242, 0.3);
    }

    /* Cards */
    .card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      padding: 24px;
      margin: 20px 0;
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s ease;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .card h3 {
      color: #feca57;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    /* Features Grid */
    .features-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin: 30px 0;
    }

    /* Event Status */
    .event-status {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
      margin: 10px 0;
    }

    .status-indicator {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #4CAF50;
    }

    .status-indicator.inactive {
      background: #f44336;
    }

    /* Event Log */
    .event-log {
      max-height: 400px;
      overflow-y: auto;
      margin: 15px 0;
    }

    .event-item {
      background: rgba(255, 255, 255, 0.03);
      border-left: 4px solid #feca57;
      padding: 12px 15px;
      margin: 8px 0;
      border-radius: 0 8px 8px 0;
    }

    .event-item.success {
      border-left-color: #4CAF50;
    }

    .event-item.error {
      border-left-color: #f44336;
    }

    .event-time {
      font-size: 12px;
      color: #888;
      margin-top: 5px;
    }

    /* Server List */
    .server-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin: 15px 0;
    }

    .server-item {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 15px;
      font-family: 'Courier New', monospace;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .server-info {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .server-job {
      color: #feca57;
      font-weight: bold;
    }

    .server-players {
      color: #4CAF50;
    }

    .server-wait {
      color: #ff6b6b;
    }

    .server-actions {
      display: flex;
      gap: 10px;
    }

    .copy-btn {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.3s ease;
    }

    .copy-btn:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    /* Footer */
    footer {
      text-align: center;
      padding: 30px;
      margin-top: 50px;
      border-top: 1px solid #333;
      background: rgba(0, 0, 0, 0.8);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .container {
        margin: 20px;
        padding: 20px;
      }
      
      .features-grid {
        grid-template-columns: 1fr;
      }
      
      .dropdown-content {
        width: 250px;
        left: -250px;
      }
      
      .server-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
      }
      
      .server-actions {
        align-self: flex-end;
      }
    }
  </style>
</head>
<body>

<div id="overlay">
  <div class="spinner"></div>
</div>

<header>
  <button class="dropbtn" id="menuBtn">
    <i class="fas fa-bars"></i>
  </button>
  <div class="logo" id="logo">
    <img src="logo.png" alt="Saki Hub Logo">
    Saki Hub
  </div>
</header>

<div class="dropdown-content" id="dropdownMenu">
  <div class="sidebar-logo">
    <i class="fas fa-cube"></i>
    Saki Hub
  </div>
  <a href="#" data-page="home" class="active">
    <i class="fas fa-home"></i>
    Trang Chủ
  </a>
  <a href="#" data-page="events">
    <i class="fas fa-calendar-alt"></i>
    Sự Kiện Game
  </a>
  <a href="#" data-page="servers">
    <i class="fas fa-server"></i>
    Servers
  </a>
  <a href="#" data-page="script">
    <i class="fas fa-code"></i>
    Script
  </a>
  <a href="#" data-page="connect">
    <i class="fas fa-users"></i>
    Kết Nối
  </a>
  <a href="#" data-page="api">
    <i class="fas fa-database"></i>
    API Documentation
  </a>
</div>

<div class="container" id="mainContent">
  <!-- Nội dung sẽ được thay đổi bằng JavaScript -->
</div>

<footer>
  <p>&copy; 2024 Saki Hub. All rights reserved.</p>
  <p>Blox Fruits Event Tracking System</p>
</footer>

<script>
  const overlay = document.getElementById('overlay');
  const menuBtn = document.getElementById('menuBtn');
  const dropdownMenu = document.getElementById('dropdownMenu');
  const mainContent = document.getElementById('mainContent');
  const logo = document.getElementById('logo');

  // API Configuration - DÙNG MOCK DATA
  const API_BASE_URL = 'https://saki-hub.vercel.app/api';
  let eventsLog = [];
  let activeServers = [];

  // Mock database
  let mockEventsDatabase = [];

  // Danh sách sự kiện Blox Fruits
  const eventsList = [
    { name: "Full Moon", world: "World 3", active: true, color: "#4CAF50" },
    { name: "Near Full Moon", world: "World 3", active: true, color: "#FF9800" },
    { name: "Mystic Island", world: "World 3", active: false, color: "#2196F3" },
    { name: "Rip Indra True Form", world: "World 3", active: true, color: "#F44336" },
    { name: "Dough King", world: "World 3", active: false, color: "#9C27B0" },
    { name: "Darkbeard", world: "World 2", active: true, color: "#607D8B" },
    { name: "Cursed Captain", world: "World 2", active: false, color: "#795548" }
  ];

  // Hàm gọi API - DÙNG MOCK
  async function callAPI(endpoint, method = 'GET', data = null) {
    // Simulate API call
    await new Promise(resolve => setTimeout(resolve, 300));
    
    if (method === 'POST' && endpoint === '/events') {
      // Mock nhận event từ Roblox
      const eventWithMetadata = {
        ...data,
        id: Date.now(),
        received_at: new Date().toISOString(),
        server_time: new Date().toLocaleString('vi-VN')
      };
      
      mockEventsDatabase.unshift(eventWithMetadata);
      if (mockEventsDatabase.length > 50) mockEventsDatabase = mockEventsDatabase.slice(0, 50);
      
      const result = { 
        success: true, 
        message: `Mock: Đã nhận event ${data.event_type}`,
        event_id: eventWithMetadata.id
      };
      
      addToLog(`${method} ${endpoint}`, 'success', result);
      return result;
    }
    else if (method === 'GET' && endpoint === '/events') {
      // Mock trả về events
      const result = {
        success: true,
        events: mockEventsDatabase,
        total: mockEventsDatabase.length,
        last_updated: new Date().toISOString()
      };
      
      addToLog(`${method} ${endpoint}`, 'success', result);
      return result;
    }
    else {
      // Mock lỗi nếu endpoint không tồn tại
      const result = { success: false, error: 'Mock: Endpoint not found' };
      addToLog(`${method} ${endpoint}`, 'error', result);
      return result;
    }
  }

  // Hàm thêm vào log
  function addToLog(action, type, data) {
    const logItem = {
      id: Date.now(),
      action,
      type,
      data,
      timestamp: new Date().toLocaleString('vi-VN')
    };
    
    eventsLog.unshift(logItem);
    if (eventsLog.length > 50) eventsLog = eventsLog.slice(0, 50);
    
    if (document.getElementById('eventsLog')) {
      updateEventsLog();
    }
  }

  // Hàm cập nhật log UI
  function updateEventsLog() {
    const logContainer = document.getElementById('eventsLog');
    if (!logContainer) return;

    logContainer.innerHTML = eventsLog.map(item => `
      <div class="event-item ${item.type}">
        <div><strong>${item.action}</strong> - ${item.type === 'success' ? '✅' : '❌'}</div>
        <div>${JSON.stringify(item.data)}</div>
        <div class="event-time">${item.timestamp}</div>
      </div>
    `).join('');
  }

  // Hàm test API
  async function testAPI() {
    const testData = {
      event_type: "test_event",
      boss_name: "Test Boss",
      players: "5/10",
      job_id: "test_" + Date.now(),
      world: "World3",
      timestamp: new Date().toISOString()
    };

    const result = await callAPI('/events', 'POST', testData);
    
    if (result.success) {
      alert('✅ Test API thành công! Data đã được lưu.');
      loadEvents(); // Load lại events
      loadServers(); // Load lại servers
    } else {
      alert('❌ Test API thất bại: ' + (result.error || 'Unknown error'));
    }
  }

  // Hàm load events từ API
  async function loadEvents() {
    const result = await callAPI('/events', 'GET');
    
    if (result.success && result.events) {
      const eventsContainer = document.getElementById('realTimeEvents');
      if (eventsContainer) {
        if (result.events.length === 0) {
          eventsContainer.innerHTML = '<p>Chưa có event nào được ghi nhận</p>';
        } else {
          eventsContainer.innerHTML = result.events.map(event => `
            <div class="event-item success">
              <div><strong>${event.boss_name || event.event_type}</strong></div>
              <div>Server: ${event.job_id || 'N/A'} | Players: ${event.players || 'N/A'}</div>
              <div>World: ${event.world || 'N/A'} | Time: ${event.time_of_day || 'N/A'}</div>
              <div class="event-time">${new Date(event.received_at).toLocaleString('vi-VN')}</div>
            </div>
          `).join('');
        }
      }
    }
  }

  // Hàm load servers từ API
  async function loadServers() {
    const result = await callAPI('/events', 'GET');
    
    if (result.success && result.events) {
      // Tạo danh sách server từ events
      const serversMap = new Map();
      
      result.events.forEach(event => {
        if (event.job_id) {
          if (!serversMap.has(event.job_id)) {
            serversMap.set(event.job_id, {
              job_id: event.job_id,
              players: event.players || 'N/A',
              last_event: event.event_type,
              timestamp: event.received_at
            });
          }
        }
      });
      
      activeServers = Array.from(serversMap.values());
      updateServersDisplay();
    }
  }

  // Hàm hiển thị servers
  function updateServersDisplay() {
    const serversContainer = document.getElementById('serversList');
    if (!serversContainer) return;

    if (activeServers.length === 0) {
      // Hiển thị mock data
      const mockServers = [
        { job_id: 'd3d6af26-e22', players: 'N/A', wait: 'N/A' },
        { job_id: 'ac60014b-c24', players: 'N/A', wait: 'N/A' },
        { job_id: '19d7983-00b', players: '4', wait: '0s' }
      ];
      
      serversContainer.innerHTML = mockServers.map(server => `
        <div class="server-item">
          <div class="server-info">
            <div class="server-job">Job: ${server.job_id}..</div>
            <div>
              <span class="server-players">Players: ${server.players}</span>
              ${server.wait !== 'N/A' ? `<span class="server-wait"> | Wait: ${server.wait}</span>` : ''}
            </div>
          </div>
          <div class="server-actions">
            <button class="copy-btn" onclick="copyJobId('${server.job_id}')">
              <i class="fas fa-copy"></i> Copy
            </button>
          </div>
        </div>
      `).join('');
    } else {
      serversContainer.innerHTML = activeServers.map(server => `
        <div class="server-item">
          <div class="server-info">
            <div class="server-job">Job: ${server.job_id}..</div>
            <div>
              <span class="server-players">Players: ${server.players}</span>
              <span class="server-wait"> | Event: ${server.last_event}</span>
            </div>
          </div>
          <div class="server-actions">
            <button class="copy-btn" onclick="copyJobId('${server.job_id}')">
              <i class="fas fa-copy"></i> Copy
            </button>
          </div>
        </div>
      `).join('');
    }
  }

  // Hàm copy Job ID
  function copyJobId(jobId) {
    navigator.clipboard.writeText(jobId).then(() => {
      alert(`Đã copy Job ID: ${jobId}`);
    }).catch(err => {
      console.error('Lỗi copy: ', err);
    });
  }

  // Hàm tạo mock data từ Roblox
  function simulateRobloxData() {
    const events = [
      {
        event_type: "full_moon",
        boss_name: "Full Moon", 
        players: "8/12",
        job_id: "d3d6af26-e22",
        world: "World3",
        time_of_day: "20:30:00"
      },
      {
        event_type: "darkbeard",
        boss_name: "Darkbeard",
        players: "5/12", 
        job_id: "ac60014b-c24",
        world: "World2",
        time_of_day: "15:45:00"
      },
      {
        event_type: "rip_indra", 
        boss_name: "Rip Indra True Form",
        players: "3/12",
        job_id: "19d7983-00b",
        world: "World3",
        time_of_day: "12:15:00"
      }
    ];

    // Thêm events ngẫu nhiên
    const randomEvent = events[Math.floor(Math.random() * events.length)];
    callAPI('/events', 'POST', {
      ...randomEvent,
      timestamp: new Date().toISOString()
    });
  }

  window.addEventListener('load', () => {
    setTimeout(() => {
      overlay.classList.add('hide');
      setTimeout(() => overlay.style.display = 'none', 500);
      mainContent.classList.add('show');
      
      const page = new URLSearchParams(window.location.search).get("page") || 
                   localStorage.getItem("currentPage") || "home";
      showPage(page);
      updateActiveNav(page);

      // Tạo mock data sau khi load
      setTimeout(simulateRobloxData, 2000);
    }, 1000);
  });

  menuBtn.addEventListener('click', () => {
    dropdownMenu.classList.toggle('show');
  });

  window.addEventListener('click', (e) => {
    if (!menuBtn.contains(e.target) && !dropdownMenu.contains(e.target)) {
      dropdownMenu.classList.remove('show');
    }
  });

  function updateActiveNav(page) {
    const links = dropdownMenu.querySelectorAll('a');
    links.forEach(link => {
      link.classList.remove('active');
      if (link.getAttribute('data-page') === page) {
        link.classList.add('active');
      }
    });
  }

  function showPage(page) {
    overlay.style.display = 'flex';
    overlay.classList.remove('hide');
    mainContent.classList.remove('show');

    setTimeout(() => {
      let content = '';
      
      switch(page) {
        case 'home':
          content = `
            <h1><i class="fas fa-home"></i> Chào Mừng Đến Saki Hub</h1>
            <p>Hệ thống theo dõi sự kiện Blox Fruits tự động và thời gian thực</p>
            
            <div class="card">
              <h3><i class="fas fa-star"></i> Giới Thiệu</h3>
              <p>Saki Hub cung cấp giải pháp theo dõi sự kiện trong game Blox Fruits một cách tự động. Hệ thống sẽ thông báo ngay lập tức khi có sự kiện mới xuất hiện.</p>
            </div>

            <div class="features-grid">
              <div class="card">
                <h3><i class="fas fa-bolt"></i> Theo Dõi Thời Gian Thực</h3>
                <p>Nhận thông báo ngay lập tức khi sự kiện xuất hiện trong game</p>
              </div>
              <div class="card">
                <h3><i class="fas fa-robot"></i> Tự Động Hoàn Toàn</h3>
                <p>Không cần can thiệp thủ công, hệ thống tự động phát hiện sự kiện</p>
              </div>
              <div class="card">
                <h3><i class="fas fa-globe"></i> Đa Nền Tảng</h3>
                <p>Hoạt động trên cả Discord và website của bạn</p>
              </div>
            </div>

            <div class="card">
              <h3><i class="fas fa-chart-line"></i> Sự Kiện Đang Hoạt Động</h3>
              ${eventsList.filter(event => event.active).map(event => `
                <div class="event-status">
                  <div class="status-indicator" style="background: ${event.color}"></div>
                  <strong>${event.name}</strong> - ${event.world}
                </div>
              `).join('')}
            </div>

            <div class="card">
              <h3><i class="fas fa-plug"></i> Trạng thái hệ thống</h3>
              <p>API Base URL: <code>${API_BASE_URL}</code></p>
              <p><strong>⚠️ Đang dùng Mock Data</strong> - API thật chưa được deploy</p>
              <div style="display: flex; gap: 10px; margin-top: 15px;">
                <button onclick="testAPI()" class="btn btn-primary">
                  <i class="fas fa-test"></i> Test API
                </button>
                <button onclick="simulateRobloxData()" class="btn" style="background: #666;">
                  <i class="fas fa-gamepad"></i> Simulate Roblox Data
                </button>
              </div>
            </div>
          `;
          break;

        case 'events':
          content = `
            <h1><i class="fas fa-calendar-alt"></i> Sự Kiện Blox Fruits - REAL TIME</h1>
            <p>Theo dõi tất cả sự kiện trong game theo thời gian thực</p>
            
            <div class="card">
              <h3><i class="fas fa-database"></i> Events từ Roblox</h3>
              <div class="event-log" id="realTimeEvents">
                <p>Đang tải dữ liệu...</p>
              </div>
              <div style="display: flex; gap: 10px; margin-top: 15px;">
                <button onclick="loadEvents()" class="btn btn-primary">
                  <i class="fas fa-sync-alt"></i> Refresh Events
                </button>
                <button onclick="testAPI()" class="btn" style="background: #666;">
                  <i class="fas fa-test"></i> Test API
                </button>
                <button onclick="simulateRobloxData()" class="btn" style="background: #9C27B0;">
                  <i class="fas fa-gamepad"></i> Simulate Data
                </button>
              </div>
            </div>

            <div class="card">
              <h3><i class="fas fa-terminal"></i> API Log</h3>
              <div class="event-log" id="eventsLog">
                <p>Chưa có activity nào</p>
              </div>
            </div>
            
            <div class="features-grid">
              ${eventsList.map(event => `
                <div class="card">
                  <h3 style="color: ${event.color}">
                    <i class="fas ${event.active ? 'fa-play' : 'fa-pause'}"></i>
                    ${event.name}
                  </h3>
                  <p><strong>Thế giới:</strong> ${event.world}</p>
                  <p><strong>Trạng thái:</strong> 
                    <span style="color: ${event.active ? '#4CAF50' : '#f44336'}">
                      ${event.active ? 'Đang hoạt động' : 'Không hoạt động'}
                    </span>
                  </p>
                  <div class="event-status">
                    <div class="status-indicator ${event.active ? '' : 'inactive'}" 
                         style="background: ${event.color}"></div>
                    <span>${event.active ? 'Đang diễn ra' : 'Chưa xuất hiện'}</span>
                  </div>
                </div>
              `).join('')}
            </div>
          `;
          break;

        case 'servers':
          content = `
            <h1><i class="fas fa-server"></i> Active Servers</h1>
            <p>Danh sách các server đang có sự kiện Blox Fruits</p>
            
            <div class="card">
              <h3><i class="fas fa-list"></i> Server List</h3>
              <div class="server-list" id="serversList">
                <p>Đang tải danh sách server...</p>
              </div>
              <div style="display: flex; gap: 10px; margin-top: 15px;">
                <button onclick="loadServers()" class="btn btn-primary">
                  <i class="fas fa-sync-alt"></i> Refresh Servers
                </button>
                <button onclick="simulateRobloxData()" class="btn" style="background: #9C27B0;">
                  <i class="fas fa-gamepad"></i> Simulate Data
                </button>
              </div>
            </div>

            <div class="card">
              <h3><i class="fas fa-info-circle"></i> Hướng dẫn</h3>
              <p>• Click "Copy" để copy Job ID của server</p>
              <p>• Sử dụng Job ID để join server thông qua script</p>
              <p>• Players: Hiển thị số người chơi hiện tại trong server</p>
            </div>
          `;
          break;

        case 'script':
          content = `
            <h1><i class="fas fa-code"></i> Script Auto Farm</h1>
            <p>Công cụ hỗ trợ chơi game Blox Fruits hiệu quả</p>
            
            <div class="card">
              <h3><i class="fas fa-download"></i> Tải Xuống</h3>
              <p>Script đang được phát triển và sẽ sớm có mặt tại đây.</p>
              <button class="btn btn-primary" style="margin-top: 15px;">
                <i class="fas fa-download"></i>
                Coming Soon
              </button>
            </div>

            <div class="card">
              <h3><i class="fas fa-shield-alt"></i> Tính Năng</h3>
              <ul style="margin-left: 20px; margin-top: 10px;">
                <li>Auto Farm hiệu quả</li>
                <li>Auto Boss khi có sự kiện</li>
                <li>Thông báo real-time</li>
                <li>An toàn và ổn định</li>
              </ul>
            </div>

            <div class="card">
              <h3><i class="fas fa-api"></i> API Integration</h3>
              <p>Script Roblox sẽ gửi dữ liệu lên API endpoint:</p>
              <code>${API_BASE_URL}/events</code>
              <p style="margin-top: 10px;">Method: POST</p>
              <p><strong>⚠️ Hiện đang dùng Mock Data</strong></p>
            </div>
          `;
          break;

        case 'connect':
          content = `
            <h1><i class="fas fa-users"></i> Kết Nối Với Chúng Tôi</h1>
            <p>Tham gia cộng đồng để nhận thông báo sự kiện mới nhất</p>
            
            <div class="features-grid">
              <div class="card">
                <h3><i class="fab fa-discord"></i> Discord</h3>
                <p>Tham gia server Discord để nhận thông báo sự kiện trực tiếp</p>
                <button id="discordBtn" class="btn btn-discord" style="margin-top: 15px;">
                  <i class="fab fa-discord"></i>
                  Join Discord
                </button>
              </div>

              <div class="card">
                <h3><i class="fas fa-envelope"></i> Hỗ Trợ</h3>
                <p>Liên hệ với chúng tôi nếu bạn cần hỗ trợ kỹ thuật</p>
                <button class="btn btn-primary" style="margin-top: 15px;">
                  <i class="fas fa-envelope"></i>
                  Contact Support
                </button>
              </div>
            </div>
          `;
          break;

        case 'api':
          content = `
            <h1><i class="fas fa-database"></i> API Documentation</h1>
            <p>Tích hợp hệ thống thông báo sự kiện vào website của bạn</p>
            
            <div class="card">
              <h3><i class="fas fa-code"></i> Base URL</h3>
              <p><code>${API_BASE_URL}</code></p>
              <p><strong>⚠️ Đang dùng Mock Data</strong> - API thật chưa được deploy</p>
              
              <div style="margin-top: 20px;">
                <h4><i class="fas fa-paper-plane"></i> Gửi sự kiện</h4>
                <p><strong>Endpoint:</strong> <code>POST /events</code></p>
                <p><strong>Body:</strong></p>
                <pre style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; overflow-x: auto;">
{
  "event_type": "full_moon",
  "boss_name": "Full Moon",
  "players": "10/12",
  "job_id": "server_job_id_here",
  "world": "World3",
  "time_of_day": "13:45:00",
  "timestamp": "2024-01-01T12:00:00Z"
}</pre>
              </div>

              <div style="margin-top: 20px;">
                <h4><i class="fas fa-download"></i> Lấy danh sách sự kiện</h4>
                <p><strong>Endpoint:</strong> <code>GET /events</code></p>
                <p>Trả về danh sách tất cả sự kiện đã nhận</p>
              </div>
            </div>

            <div class="card">
              <h3><i class="fas fa-key"></i> Test API</h3>
              <p>Kiểm tra kết nối API của bạn</p>
              <div style="display: flex; gap: 10px;">
                <button onclick="testAPI()" class="btn btn-primary">
                  <i class="fas fa-test"></i> Test API Connection
                </button>
                <button onclick="simulateRobloxData()" class="btn" style="background: #9C27B0;">
                  <i class="fas fa-gamepad"></i> Simulate Roblox Data
                </button>
              </div>
            </div>
          `;
          break;
      }

      mainContent.innerHTML = content;
      
      // Thêm event listener cho nút Discord
      const discordBtn = document.getElementById("discordBtn");
      if (discordBtn) {
        discordBtn.addEventListener("click", () => {
          window.open("https://discord.gg/YSfqv7ee", "_blank");
        });
      }

      // Load data nếu đang ở trang tương ứng
      if (page === 'events') {
        setTimeout(() => {
          loadEvents();
          updateEventsLog();
        }, 100);
      } else if (page === 'servers') {
        setTimeout(() => {
          loadServers();
        }, 100);
      }

      overlay.classList.add('hide');
      setTimeout(() => overlay.style.display = 'none', 500);
      mainContent.classList.add('show');
      
      localStorage.setItem("currentPage", page);
      updateActiveNav(page);
      
      const url = new URL(window.location);
      url.searchParams.set('page', page);
      window.history.replaceState({}, '', url);
    }, 800);
  }

  const links = dropdownMenu.querySelectorAll('a');
  links.forEach(link => {
    link.addEventListener('click', (e) => {
      e.preventDefault();
      const page = link.getAttribute('data-page');
      showPage(page);
      dropdownMenu.classList.remove('show');
    });
  });

  logo.addEventListener('click', () => {
    showPage('home');
  });

  // Tự động refresh data mỗi 30 giây
  setInterval(() => {
    const currentPage = localStorage.getItem("currentPage") || "home";
    if (currentPage === 'events') {
      loadEvents();
    } else if (currentPage === 'servers') {
      loadServers();
    }
  }, 30000);

  // Tự động tạo mock data mỗi 2 phút
  setInterval(() => {
    simulateRobloxData();
  }, 120000);
</script>

</body>
</html>
